<html>
    <head>
        <script src='../google/tensorflow2.7.0.min.js'></script>
        <script src='../TFLayerPath.js'></script>

        <script>
            //shortcut varialbes
            var cropSize=64;var C=1+(2+4),Cx=3;var scale=.3
            var normalize={r:0,c:C,divide:255,w:cropSize,h:cropSize,x:0,y:0,xscale:scale,yscale:scale,rescale:false};

            var defaultActivation='relu6';
            var inputActivation='relu6';
            var _mse='meanSquaredError';
            var _cce='categoricalCrossentropy';
            var lrm=1;//Learning rate multiplier
            var l=tf.layers;
            var t=tf.tensor;
            var myloss=_mse;

        </script>
        <script>
            var p1=new TFLayerPath();
            p1.add('in1',tf.input({shape:[2]}));
            //p1.add('cx',l.concatenate(),['in1','in1','in1']);
            p1.add('a1',l.dense({units:1}),'in1');
            p1.add('b1',l.dense({units:2}),'a1');
            p1.add('a2',p1.get('a1'),'in1');
            p1.add('b2',p1.get('b1'),'a2');
            p1.add('cx2',l.concatenate(),['b1','b2']);
            var m=tf.model({inputs:[p1.get("in1")],outputs:[p1.apply()]});
            console.log(m.summary());
            m.compile({
                optimizer: //tf.train.momentum(1e-4,0.95)
                        tf.train.adam(0.0001*lrm,1e-8)//learning rate
                ,loss: myloss
                ,metrics:['accuracy']
            });
        </script>
    </head>
</html>